{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  const sendMessage = async () => {\n    if (!inputMessage?.trim() || isLoading) return;\n    const userMessage = inputMessage;\n    setInputMessage(\"\");\n    setMessages(prev => [...prev, {\n      role: \"user\",\n      content: userMessage\n    }]);\n    setIsLoading(true);\n    try {\n      let aiText = \"\";\n      if (Platform.OS === \"web\" && window?.puter?.ai?.chat) {\n        // Web: Puter.js\n        const response = await window.puter.ai.chat(userMessage, {\n          model: \"gpt-5-chat-latest\"\n        });\n        aiText = response?.message?.content || response?.message || \"⚠️ No response from AI.\";\n      } else {\n        // Mobile / React Native: fetch from Node server\n        const apiUrl = \"http://172.28.138.8:3001/api/chat\"; // replace with your PC LAN IP\n\n        const res = await fetch(apiUrl, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            messages: [...messages, {\n              role: \"user\",\n              content: userMessage\n            }]\n          })\n        });\n\n        // Read as text first to handle HTML or errors\n        const text = await res.text();\n        try {\n          const data = JSON.parse(text);\n          aiText = data.message || \"⚠️ No response from AI.\";\n        } catch (jsonErr) {\n          console.error(\"AI server returned invalid JSON:\", text);\n          aiText = \"⚠️ AI server returned invalid JSON (check server logs)\";\n        }\n      }\n      setMessages(prev => [...prev, {\n        role: \"assistant\",\n        content: aiText\n      }]);\n    } catch (err) {\n      console.error(\"AI error:\", err);\n      setMessages(prev => [...prev, {\n        role: \"assistant\",\n        content: \"⚠️ Sorry, an error occurred while contacting AI.\"\n      }]);\n    } finally {\n      setIsLoading(false);\n      setTimeout(() => scrollRef.current?.scrollToEnd({\n        animated: true\n      }), 100);\n    }\n  };\n});","lineCount":63,"map":[[2,2,1,0],[2,8,1,6,"sendMessage"],[2,19,1,17],[2,22,1,20],[2,28,1,20,"sendMessage"],[2,29,1,20],[2,34,1,32],[3,4,2,2],[3,8,2,6],[3,9,2,7,"inputMessage"],[3,21,2,19],[3,23,2,21,"trim"],[3,27,2,25],[3,28,2,26],[3,29,2,27],[3,33,2,31,"isLoading"],[3,42,2,40],[3,44,2,42],[4,4,4,2],[4,10,4,8,"userMessage"],[4,21,4,19],[4,24,4,22,"inputMessage"],[4,36,4,34],[5,4,5,2,"setInputMessage"],[5,19,5,17],[5,20,5,18],[5,22,5,20],[5,23,5,21],[6,4,6,2,"setMessages"],[6,15,6,13],[6,16,6,15,"prev"],[6,20,6,19],[6,24,6,24],[6,25,6,25],[6,28,6,28,"prev"],[6,32,6,32],[6,34,6,34],[7,6,6,36,"role"],[7,10,6,40],[7,12,6,42],[7,18,6,48],[8,6,6,50,"content"],[8,13,6,57],[8,15,6,59,"userMessage"],[9,4,6,71],[9,5,6,72],[9,6,6,73],[9,7,6,74],[10,4,7,2,"setIsLoading"],[10,16,7,14],[10,17,7,15],[10,21,7,19],[10,22,7,20],[11,4,9,2],[11,8,9,6],[12,6,10,4],[12,10,10,8,"aiText"],[12,16,10,14],[12,19,10,17],[12,21,10,19],[13,6,12,4],[13,10,12,8,"Platform"],[13,18,12,16],[13,19,12,17,"OS"],[13,21,12,19],[13,26,12,24],[13,31,12,29],[13,35,12,33,"window"],[13,41,12,39],[13,43,12,41,"puter"],[13,48,12,46],[13,50,12,48,"ai"],[13,52,12,50],[13,54,12,52,"chat"],[13,58,12,56],[13,60,12,58],[14,8,13,6],[15,8,14,6],[15,14,14,12,"response"],[15,22,14,20],[15,25,14,23],[15,31,14,29,"window"],[15,37,14,35],[15,38,14,36,"puter"],[15,43,14,41],[15,44,14,42,"ai"],[15,46,14,44],[15,47,14,45,"chat"],[15,51,14,49],[15,52,14,50,"userMessage"],[15,63,14,61],[15,65,14,63],[16,10,15,8,"model"],[16,15,15,13],[16,17,15,15],[17,8,16,6],[17,9,16,7],[17,10,16,8],[18,8,17,6,"aiText"],[18,14,17,12],[18,17,17,15,"response"],[18,25,17,23],[18,27,17,25,"message"],[18,34,17,32],[18,36,17,34,"content"],[18,43,17,41],[18,47,17,45,"response"],[18,55,17,53],[18,57,17,55,"message"],[18,64,17,62],[18,68,17,66],[18,93,17,91],[19,6,18,4],[19,7,18,5],[19,13,18,11],[20,8,19,6],[21,8,20,6],[21,14,20,12,"apiUrl"],[21,20,20,18],[21,23,20,21],[21,58,20,56],[21,59,20,57],[21,60,20,58],[23,8,22,6],[23,14,22,12,"res"],[23,17,22,15],[23,20,22,18],[23,26,22,24,"fetch"],[23,31,22,29],[23,32,22,30,"apiUrl"],[23,38,22,36],[23,40,22,38],[24,10,23,8,"method"],[24,16,23,14],[24,18,23,16],[24,24,23,22],[25,10,24,8,"headers"],[25,17,24,15],[25,19,24,17],[26,12,24,19],[26,26,24,33],[26,28,24,35],[27,10,24,54],[27,11,24,55],[28,10,25,8,"body"],[28,14,25,12],[28,16,25,14,"JSON"],[28,20,25,18],[28,21,25,19,"stringify"],[28,30,25,28],[28,31,25,29],[29,12,25,31,"messages"],[29,20,25,39],[29,22,25,41],[29,23,25,42],[29,26,25,45,"messages"],[29,34,25,53],[29,36,25,55],[30,14,25,57,"role"],[30,18,25,61],[30,20,25,63],[30,26,25,69],[31,14,25,71,"content"],[31,21,25,78],[31,23,25,80,"userMessage"],[32,12,25,92],[32,13,25,93],[33,10,25,95],[33,11,25,96],[34,8,26,6],[34,9,26,7],[34,10,26,8],[36,8,28,6],[37,8,29,6],[37,14,29,12,"text"],[37,18,29,16],[37,21,29,19],[37,27,29,25,"res"],[37,30,29,28],[37,31,29,29,"text"],[37,35,29,33],[37,36,29,34],[37,37,29,35],[38,8,31,6],[38,12,31,10],[39,10,32,8],[39,16,32,14,"data"],[39,20,32,18],[39,23,32,21,"JSON"],[39,27,32,25],[39,28,32,26,"parse"],[39,33,32,31],[39,34,32,32,"text"],[39,38,32,36],[39,39,32,37],[40,10,33,8,"aiText"],[40,16,33,14],[40,19,33,17,"data"],[40,23,33,21],[40,24,33,22,"message"],[40,31,33,29],[40,35,33,33],[40,60,33,58],[41,8,34,6],[41,9,34,7],[41,10,34,8],[41,17,34,15,"jsonErr"],[41,24,34,22],[41,26,34,24],[42,10,35,8,"console"],[42,17,35,15],[42,18,35,16,"error"],[42,23,35,21],[42,24,35,22],[42,58,35,56],[42,60,35,58,"text"],[42,64,35,62],[42,65,35,63],[43,10,36,8,"aiText"],[43,16,36,14],[43,19,36,17],[43,75,36,73],[44,8,37,6],[45,6,38,4],[46,6,40,4,"setMessages"],[46,17,40,15],[46,18,40,17,"prev"],[46,22,40,21],[46,26,40,26],[46,27,40,27],[46,30,40,30,"prev"],[46,34,40,34],[46,36,40,36],[47,8,40,38,"role"],[47,12,40,42],[47,14,40,44],[47,25,40,55],[48,8,40,57,"content"],[48,15,40,64],[48,17,40,66,"aiText"],[49,6,40,73],[49,7,40,74],[49,8,40,75],[49,9,40,76],[50,4,41,2],[50,5,41,3],[50,6,41,4],[50,13,41,11,"err"],[50,16,41,14],[50,18,41,16],[51,6,42,4,"console"],[51,13,42,11],[51,14,42,12,"error"],[51,19,42,17],[51,20,42,18],[51,31,42,29],[51,33,42,31,"err"],[51,36,42,34],[51,37,42,35],[52,6,43,4,"setMessages"],[52,17,43,15],[52,18,43,17,"prev"],[52,22,43,21],[52,26,43,26],[52,27,44,6],[52,30,44,9,"prev"],[52,34,44,13],[52,36,45,6],[53,8,45,8,"role"],[53,12,45,12],[53,14,45,14],[53,25,45,25],[54,8,45,27,"content"],[54,15,45,34],[54,17,45,36],[55,6,45,87],[55,7,45,88],[55,8,46,5],[55,9,46,6],[56,4,47,2],[56,5,47,3],[56,14,47,12],[57,6,48,4,"setIsLoading"],[57,18,48,16],[57,19,48,17],[57,24,48,22],[57,25,48,23],[58,6,49,4,"setTimeout"],[58,16,49,14],[58,17,49,15],[58,23,49,21,"scrollRef"],[58,32,49,30],[58,33,49,31,"current"],[58,40,49,38],[58,42,49,40,"scrollToEnd"],[58,53,49,51],[58,54,49,52],[59,8,49,54,"animated"],[59,16,49,62],[59,18,49,64],[60,6,49,69],[60,7,49,70],[60,8,49,71],[60,10,49,73],[60,13,49,76],[60,14,49,77],[61,4,50,2],[62,2,51,0],[62,3,51,1],[63,0,51,2],[63,3]],"functionMap":{"names":["<global>","sendMessage","setMessages$argument_0","setTimeout$argument_0"],"mappings":"AAA,oBC;cCK,2DD;gBCkC,2DD;gBCG;KDG;eEG,wDF;CDE"},"hasCjsExports":false},"type":"js/module"}]}